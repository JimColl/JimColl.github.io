<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.4.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="James Matthew Coll">

  
  
  
    
  
  <meta name="description" content="Lab 8: Advanced Terrain Analysis Learning Objective In this lab we&rsquo;ll cover a variety of terrain analysis techniques including shelter analysis, the hydrology toolbox, and how to use radar data and terrain to identify blocked locations.
What you need to submit Lab 8: Answer Sheet
Name:
Part 1 Question 1:
What is the value of the majority of the cells on the focalcells raster layer?
Where are the cells with smaller values located?">

  
  <link rel="alternate" hreflang="en-us" href="https://jimcoll.github.io/courses/geog558/lab08/">

  


  

  
  
  
  <meta name="theme-color" content="#4caf50">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.5f8a892bbf54831e755facb704359ff8.css">

  

  
  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://jimcoll.github.io/courses/geog558/lab08/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Jim Coll">
  <meta property="og:url" content="https://jimcoll.github.io/courses/geog558/lab08/">
  <meta property="og:title" content=" | Jim Coll">
  <meta property="og:description" content="Lab 8: Advanced Terrain Analysis Learning Objective In this lab we&rsquo;ll cover a variety of terrain analysis techniques including shelter analysis, the hydrology toolbox, and how to use radar data and terrain to identify blocked locations.
What you need to submit Lab 8: Answer Sheet
Name:
Part 1 Question 1:
What is the value of the majority of the cells on the focalcells raster layer?
Where are the cells with smaller values located?"><meta property="og:image" content="https://jimcoll.github.io/img/icon-192.png">
  <meta property="twitter:image" content="https://jimcoll.github.io/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
    
  

  


  





  <title> | Jim Coll</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Jim Coll</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/"><span>Main Website</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/geog358/"><span>GEOG 358</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/courses/geog558/"><span>GEOG 558</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/dronemapping/"><span>Drone Mapping</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/random/"><span>Random</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/geog558/">Class Outline</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/geog558/classoutline/">Introduction and Syllabus</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/geog558"></a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/geog558/lab01/">Labs</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/geog558/lab01/">Lab 1 - Data survey and database building</a>
      </li>
      
      <li >
        <a href="/courses/geog558/lab02/">Lab 2 - Cartographic Modeling</a>
      </li>
      
      <li >
        <a href="/courses/geog558/lab03/">Lab 3 - Focal Operations</a>
      </li>
      
      <li >
        <a href="/courses/geog558/lab04/">Lab 4 - Zonal Operations</a>
      </li>
      
      <li >
        <a href="/courses/geog558/lab05/">Lab 5 - Model Builder</a>
      </li>
      
      <li >
        <a href="/courses/geog558/lab06/">Lab 6 - Cost Distance, Region Groups, more Model Builder &amp; Python</a>
      </li>
      
      <li >
        <a href="/courses/geog558/lab07/">Lab 7 - Siting a New School with Model Builder and Fungus Dispersion Modeling</a>
      </li>
      
      <li class="active">
        <a href="/courses/geog558/lab08/">Lab 8 - Advanced Terrain Analysis</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
<ul>
<li><a href="#lab-8-advanced-terrain-analysis"><strong>Lab 8: Advanced Terrain Analysis</strong></a></li>
<li><a href="#learning-objective"><strong>Learning Objective</strong></a></li>
<li><a href="#what-you-need-to-submit"><strong>What you need to submit</strong></a></li>
<li><a href="#materials"><strong>Materials</strong></a></li>
<li><a href="#part-1-terrain-exposure-analysis"><strong>Part 1: Terrain Exposure Analysis</strong></a>
<ul>
<li><a href="#getting-set-up"><strong>Getting set up</strong></a></li>
<li><a href="#terrain-exposure-analysis-procedure"><strong>Terrain Exposure Analysis Procedure</strong></a></li>
</ul></li>
<li><a href="#part-2-watershed-and-stream-delineation"><strong>Part 2: Watershed and Stream Delineation</strong></a>
<ul>
<li><a href="#getting-set-up-1"><strong>Getting set up</strong></a></li>
<li><a href="#identify-sinks"><strong>Identify sinks</strong></a></li>
<li><a href="#fill-original-dem-and-identify-sinks"><strong>Fill original DEM and identify sinks</strong></a></li>
<li><a href="#compute-a-new-flow-direction"><strong>Compute a new flow direction</strong></a></li>
<li><a href="#identify-and-clip-to-the-white-oak-watershed"><strong>Identify and clip to the White Oak watershed</strong></a></li>
<li><a href="#compute-flow-accumulation"><strong>Compute flow accumulation</strong></a></li>
<li><a href="#extract-stream-network"><strong>Extract stream network</strong></a></li>
<li><a href="#extract-sub-basins-for-each-stream-segment"><strong>Extract sub basins for each stream segment</strong></a></li>
<li><a href="#compute-water-surface-flow-distance"><strong>Compute water surface flow distance</strong></a></li>
</ul></li>
<li><a href="#part-3-examining-nexrad-radar-beam-terrain-blockage"><strong>Part 3: Examining NEXRAD radar beam terrain blockage</strong></a>
<ul>
<li><a href="#getting-set-up-2"><strong>Getting set up</strong></a></li>
<li><a href="#create-nexrad-radar-beam-shapefile"><strong>Create NEXRAD radar beam shapefile</strong></a></li>
<li><a href="#define-the-spatial-reference-for-the-radar-beam-shapefile"><strong>Define the spatial reference for the radar beam shapefile</strong></a></li>
<li><a href="#establish-indices-for-radar-beam-radials"><strong>Establish indices for radar beam radials</strong></a></li>
<li><a href="#determine-where-radar-beam-intersects-terrain"><strong>Determine where radar beam intersects terrain</strong></a></li>
<li><a href="#determine-locations-where-the-radar-beam-is-blocked-by-terrain"><strong>Determine locations where the radar beam is blocked by terrain</strong></a></li>
<li><a href="#invert-the-selection-and-create-a-radar-beam-raster"><strong>Invert the selection and create a radar beam raster</strong></a></li>
<li><a href="#visualize-the-results-in-3-d"><strong>Visualize the results in 3-D</strong></a></li>
</ul></li>
</ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article" itemscope itemtype="http://schema.org/Article">

        <div class="docs-article-container">
          <h1 itemprop="name"></h1>

          <div class="article-style" itemprop="articleBody">
            

<h1 id="lab-8-advanced-terrain-analysis"><strong>Lab 8: Advanced Terrain Analysis</strong></h1>

<h1 id="learning-objective"><strong>Learning Objective</strong></h1>

<p>In this lab we&rsquo;ll cover a variety of terrain analysis techniques including shelter analysis, the hydrology toolbox, and how to use radar data and terrain to identify blocked locations.</p>

<h1 id="what-you-need-to-submit"><strong>What you need to submit</strong></h1>

<hr />

<p><strong>Lab 8: Answer Sheet</strong><br />
Name:</p>

<p><strong>Part 1</strong>
<strong>Question 1</strong>:<br />
What is the value of the majority of the cells on the focalcells raster layer?</p>

<p>Where are the cells with smaller values located?</p>

<p>and why do they have smaller values?</p>

<p><strong>Question 2</strong>:<br />
What is the value range in the shelter analysis raster layer?
________ to ________</p>

<p>A large positive value means:</p>

<p>A value close to zero means:</p>

<p>A small negative value means:</p>

<p><strong>Part 2</strong>
<strong>Question 3</strong>: How many sink cells exist in the Bethel DEM? ________<br />
(Hint: Open the Attribute Table, you will need to use Statistics)</p>

<p><strong>Question 4</strong>: The maximum sink depth in the bethel DEM is ________ m</p>

<p><strong>Question 5</strong>: Number of sinks in the filled DEM:________</p>

<p><strong>Question 6</strong>: What is the total watershed area for the b_gauge station?
________ Cells = ________ km<sup>2</sup></p>

<p><strong>Question 7</strong>: How many different stream segments inside the watershed? ________</p>

<p><strong>Question 8</strong>: What’s the highest Strahler stream order in the watershed? ________</p>

<p>Paste your watershed map here:</p>

<p><strong>Question 9</strong>: How far is the whiteoak_gauge from the farthest divide? ________ m</p>

<p>In this part of the assignment, you will run through some of the same operations used in part 02 of the lab exercise using a different data set. The purpose of doing this is to ensure that you understand the processes involved and that you are not simply clicking through the steps without thought.   You will use the Rio Fajardo River dataset (riofajardo DEM &amp; r_gauges.shp) to complete your lab assignment. Remember to set up your Spatial Analyst environment appropriately – all raster manipulations should use the same extent and cell size as the original riofajardo.  Also remember to reset the Spatial Analyst Options after running the watershed analysis.</p>

<p>Begin by adding a new data frame (named Rio Fajardo) to your ArcMap project and adding the Rio Fajardo files (riofajardo DEM &amp; r_gauge.shp). Notice that r_gauge.shp actually contains 5 gauging stations (as opposed to the 1 station in b_gauge.shp). This will be important later in the assignment.  I HIGHLY suggest that you use the same naming conventions which were used in the Bethel example. For example, your filled Rio Fajardo DEM should be named r_filled. This will make the process much easier, especially when figuring out what should be put into Raster Calculator computations.  Start the process by setting Spatial Analyst’s extent, mask and cell size to the original DEM (riofajardo), then fill the Rio Farjardo DEM (see Step 3 in the lab exercise).</p>

<p><strong>Question 10</strong>: What is the maximum depth of the sinks in the Rio Farjardo DEM?  ________ m</p>

<p><strong>Question 11</strong>: How many sinks in the filled DEM? ________</p>

<p><strong>Question 12</strong>: Delineate the Rio Fajardo watershed (Steps 4 &amp; 5 in lab exercise).  What is the area of the entire Rio Fajardo watershed?
________ Cells = ________ km<sup>2</sup></p>

<p>Now you will focus on a particular gauge in the r_gauge shapefile – the Rio Fajardo near Fajardo gauge. First, create a new data frame named Near Fajardo Gauge. Copy riofajardo, r_gauge, r_flowdir, and r_filled layers from your Rio Fajardo dataframe to your Near Fajardo Gauge dataframe. Double check your Environments to make sure the extent and cell size are still set to riofajardo.</p>

<p>Calculate the watershed for the Rio Fajardo near Fajardo station only. In order to do this, you should export the near Fajardo station into its own shapefile You can <i>Select the gage &gt; R-click on the layer &gt; Selection &gt; Create Layer from Selected Features &gt; Rename it to nearfaj_gage.</i></p>

<p><strong>Question 13</strong>: What is the area of the Rio Fajardo near Fajardo watershed?
________ Cells = ________ km<sup>2</sup></p>

<p>You will need to clip the r_filled &amp; r_flowdir to the Rio Fajardo near Fajardo (like you did to get b_gdem &amp; b_gdir).</p>

<p>Extract the stream network of the Rio Fajardo near Fajardo watershed (Steps 6 and 7 in the lab exercise). Use 200 cells as the flow accumulation threshold.</p>

<p><strong>Question 14</strong>: What is the highest Strahler stream order # at the Rio Fajardo near Fajardo station? ________</p>

<p><strong>Part 3</strong>
<strong>Question 15</strong>: How many sample points are in the blocked beam region? ________</p>

<p><strong>Question 16</strong>: Export the scene in 2D as a PNG file and call it part3yourname.png. Make sure you’re saving to your Lab08 folder! Leave the rest of the options to the defaults. Upload your PNG files from part 1 and 2 to the lab 8 assignments section on Blackboard. Make sure you put your name in the filename names.</p>

<p><strong>Question 17</strong>: Let’s say that the KPUX radar’s elevation angle has been increased from 0.5 degrees to 0.8 degrees. Open notepad and edit the kpux.txt file, changing the elevangle parameter to 0.8.  Repeat steps 2 through 6 using this new kpux.txt file. Be sure to use naming convention (change 005 suffixes to 008). How many sample points are blocked in the beam region now?  ________</p>

<hr />

<h1 id="materials"><strong>Materials</strong></h1>

<p><a href="https://kansas-my.sharepoint.com/:f:/g/personal/j610c377_home_ku_edu/EuXcVmpEfGZCnaEhU39f4woB4-h-1ZxBX-NHUJcVEsMonA?e=iKEEID">click to download</a><br />
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;border-color:#ccc;margin:0px auto;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#ccc;color:#333;background-color:#fff;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#ccc;color:#333;background-color:#f0f0f0;}
.tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-btxf{background-color:#f9f9f9;border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg">
  <tr>
    <th class="tg-0pky">Relevant part</th>
    <th class="tg-0pky">Data Name</th>
    <th class="tg-0pky">Description</th>
  </tr>
  <tr>
    <th class="tg-0pky">Part 1</th>
    <td class="tg-btxf">chase_dem</td>
    <td class="tg-btxf">DEM for Chase County, KS (30m cell size, elevation in feet)</td>
  </tr>
  <tr>
    <th class="tg-0pky">Part 2</th>
    <td class="tg-btxf">bethel</td>
    <td class="tg-btxf">Raster representing a DEM for the Bethel Valley Quad 1:24,000 topographic map sheet from USGS (30m x 30m cell size; height in meters)</td>
  </tr>
  <tr>
    <th class="tg-0pky">Part 2</th>
    <td class="tg-btxf">b_gauge.shp</td>
    <td class="tg-btxf">Hypothetical gage location on White Oak Creek in the Bethel DEM watershed</td>
  </tr>
  <tr>
    <th class="tg-0pky">Part 2</th>
    <td class="tg-btxf">riofajardo</td>
    <td class="tg-btxf">Raster representing a DEM for part of the Fajardo municipio in Puerto Rico (30m x 30m cell size; height in meters)</td>
  </tr>
  <tr>
    <th class="tg-0pky">Part 2</th>
    <td class="tg-btxf">r_gauge.shp</td>
    <td class="tg-btxf">Locations of gaging stations &amp; the Rio Fajardo River outlet</td>
  </tr>
  <tr>
    <th class="tg-0pky">Part 3</th>
    <td class="tg-btxf">dem200</td>
    <td class="tg-btxf">Raster representing a DEM for the area surrounding Pueblo, Colorado (200m x 200m cell size; elevation in meters)</td>
  </tr>
  <tr>
    <th class="tg-0pky">Part 3</th>
    <td class="tg-btxf">nexrad_kpux.shp</td>
    <td class="tg-btxf">Pueblo, CO NEXRAD radar location</td>
  </tr>
  <tr>
    <th class="tg-0pky">Part 3</th>
    <td class="tg-btxf">kpux.txt</td>
    <td class="tg-btxf">Text file containing the KPUX radar properties</td>
  </tr>
</table></p>

<hr />

<h1 id="part-1-terrain-exposure-analysis"><strong>Part 1: Terrain Exposure Analysis</strong></h1>

<p>In this part of the lab, we will perform a terrain exposure analysis, referred to as shelter analysis.  The outputs of this workflow are quite popular in archeology studies and inform us as to how protected a given location is.</p>

<h2 id="getting-set-up"><strong>Getting set up</strong></h2>

<p>Start Arcmap and rename the data frame to Terrain Exposure Analysis.  Because we are working at a relatively small geographic scale, we should first reproject our raster from it&rsquo;s native projection () to a more appropriate one for this analysis (Kansas State Plane Coordinate System (South Zone)).</p>

<ul>
<li>Open ArcToolbox and navigate to Data Management Tools | Projections and Transformations | Raster | Project Raster</li>
<li>For your Input raster select you chase_dem from your lab08\part01 folder using the browse button.

<ul>
<li>Here we use the browse button to avoid data locks on the elevation data and avoid inadvertently assigning a projection to the dataframe prematurely.</li>
</ul></li>
<li>Make the Output raster proj_dem saved in your lab08\part01 folder</li>
<li>To select an Output coordinate system, click on the Spatial Reference Properties Button (the hand with the card)</li>
<li>Define the coordinate system as:

<ul>
<li>Projected Coordinate Systems &gt; State Plane &gt; NAD 1983 (meters) &gt; NAD 1983 StatePlane Kansas South FIPS 1502 (meters).prj</li>
</ul></li>
<li>Click OK</li>
<li>Make sure that the Resampling technique is set to NEAREST, and the cell size to 30m</li>
<li>Make sure your window looks like the one below (you may need to scroll down or resize the window)</li>
<li>Click OK
<img src="/courses/geog558/media/Lab8Image1.png" alt="" /></li>
</ul>

<p>Finally, let&rsquo;s convert the elevation from feet to meters.</p>

<ul>
<li><em>1 foot = 0.3048 meters</em><br /></li>
<li>Name the output <i>chase_m</i><br /></li>
</ul>

<h2 id="terrain-exposure-analysis-procedure"><strong>Terrain Exposure Analysis Procedure</strong></h2>

<ul>
<li>Use Raster Calculator to create a constant raster layer on which all of the cells have a value of 1 <i>(“chase_m” / “chase_m”)</i>.</li>
<li>Make the output raster a permanent raster named constant</li>
<li>Calculate the FOCALSUM on the constant raster layer using a circular neighborhood with a radius of 2 cell size</li>
<li>Save the output raster layer as focalcells in your part01 folder</li>
<li>Answer question #1 on your assignment sheet</li>
<li>Calculate the earth volume within the circular neighborhood (do a FOCALSUM operation using chase_m with a neighborhood radius of 2)</li>
<li>Save the output raster layer as earthv1 in your part03 folder</li>
<li>Calculate the earth volume within the circular neighborhood assuming all the cells inside the neighborhood have the same Z value as the focus (“chase_m” * “focalcells”)</li>
<li>Save the output raster layer as earthv2 in your lab03\part03 folder</li>
<li>Calculate the shelter raster layer by  subtracting earthv2 from earthv1 (“earthv1” – “earthv2”)</li>
<li>Save the output raster layer as shelter in your part03 folder</li>
<li>Answer question #2 on your assignment sheet</li>
</ul>

<hr />

<h1 id="part-2-watershed-and-stream-delineation"><strong>Part 2: Watershed and Stream Delineation</strong></h1>

<p>Hydrology and GIS are closely linked, as spatial developments in the hydrologic sciences were some of the first to be ported into GISystems when ESRI became a company.  In this lab we will use some of the most common hydrology tools to perform some common analyses including how the fundamental hydrology tools (flow accumulation, flow direction) are used in hydrologic modeling, how to group contiguous sets of cells, how raster calculator is used in this hydrologic context, and how to delineate streams, watersheds, and drainage characteristics.</p>

<h2 id="getting-set-up-1"><strong>Getting set up</strong></h2>

<ul>
<li>Either start a new session of ArcMap or insert a new dataframe and rename it to Bethel Valley</li>
<li>Add bethel and b_gauge.shp to the Bethel Valley data frame</li>
<li>Go to Geoprocessing | Environments… and…

<ul>
<li>Set the Current Workspace and Scratch Workspace to your lab08\Part02 folder</li>
<li>Set Processing Extent and cell size (under Raster Analysis) to “Same as layer bethel”
<br /></li>
</ul></li>
</ul>

<h2 id="identify-sinks"><strong>Identify sinks</strong></h2>

<ul>
<li>Open ArcToolbox and select Spatial Analyst Tools | Hydrology</li>
<li>Calculate flow directions without filling the sinks by going to Hydrology | Flow Direction

<ul>
<li>Make sure bethel is the input surface, leave others to the defaults, and name your output b_flow</li>
</ul></li>
<li>Use the hydrological modeling to identify the sinks in the bethel DEM by navigating to Hydrology | Sink in ArcToolbox

<ul>
<li>Set the flow direction raster (b_flow) as the input, name the output file b_sinkid</li>
</ul></li>
<li>Answer Question 3.</li>
</ul>

<h2 id="fill-original-dem-and-identify-sinks"><strong>Fill original DEM and identify sinks</strong></h2>

<ul>
<li>Fill sinks in the bethel DEM by going to Hydrology | Fill

<ul>
<li>Set the bethel DEM as the input surface and name the output b_filled</li>
</ul></li>
<li>Find the depth of the filled sinks by using Raster Calculator

<ul>
<li>Think about what we just did: We filled in all the pits, so how would you get the depth?</li>
<li>This was also the first step to getting lake volume, we just need to subtract the top from the bottom: <i>filled DEM (b_filled/Top) minus original DEM (bethel/Bottom)</i></li>
<li>Name the output <i>b_sink_depth</i></li>
</ul></li>
<li>Answer Question 4.</li>
<li>Reclassify (Spatial Analyst) the depth raster (b_sink_depth) so that sink cells (Old value &gt; 0) have a value of 1 and non-sink cells (Old Value &lt;= 0) have a value of NODATA.

<ul>
<li>Name the output b_sinks
<img src="/courses/geog558/media/Lab8Image2.png" alt="" /></li>
</ul></li>
<li>Use the Region Group tool (Spatial Analysis Tools | Generalization | Region Group) to assign a connected set of sink cells a unique number

<ul>
<li>Set the input raster to b_sinks, the output raster to b_sink_reg, and the number of neighbors to use to Eight. Leave all other fields to default.</li>
</ul></li>
<li>Answer Question 5.</li>
</ul>

<h2 id="compute-a-new-flow-direction"><strong>Compute a new flow direction</strong></h2>

<ul>
<li>Compute flow direction from the filled Bethel DEM (b_filled) raster by going to Hydrology | Flow Direction.

<ul>
<li>Set the filled Bethel DEM (b_filled) as the input surface and name the output grid b_flowdir</li>
</ul></li>
</ul>

<h2 id="identify-and-clip-to-the-white-oak-watershed"><strong>Identify and clip to the White Oak watershed</strong></h2>

<ul>
<li>Identify the upstream drainage area (watershed) for the White Oak gauge (b_gauge.shp)

<ul>
<li>Convert the gauge shapefile into a raster layer and name it b_ras_gauge  (Conversion Tools | To Raster | Point to Raster).</li>
<li>Select b_gauge as the Input Feature, ID as the Value field and 30 as the cell size.
<img src="/courses/geog558/media/Lab8Image3.png" alt="" /></li>
</ul></li>
<li>Use the Watershed function:

<ul>
<li>Input rasters: b_flowdir for flow direction, b_ras_gauge for pour point data.</li>
<li>Use Value for pour point field and name the output b_watershed.</li>
</ul></li>
</ul>

<blockquote>
<p>You may ask yourself “Why did we perform that last step if the pour point can also be a feature?”  You are correct, that was a superfluous transformation.  But now you know how to do that for future reference; because knowing is half the battle, and knowledge is power!</p>
</blockquote>

<ul>
<li>Answer Question 6.</li>
<li>In Geoprocessing | Environments, set the extent, cell size, and mask to b_watershed. Also check the working directory (Note: After you use the Watershed function, it may reset the environment. This is a bug in the extension which was introduced in 10.3, and may still crop up in 10.6)</li>
<li>In Raster Calculator, use b_watershed to clip the filled DEM (b_filled) and flow direction raster to the White Oak watershed. Because you set the analysis mask to b_watershed in the previous step, your expression will simply be the name of the raster with no other operations; simply enter “b_filled” as the entire expression. Name the output b_gdem</li>
<li>Repeat the above step for b_flowdir and name the output b_gdir

<ul>
<li>Stop and think about how else might you might accomplish this operation?</li>
</ul></li>
</ul>

<h2 id="compute-flow-accumulation"><strong>Compute flow accumulation</strong></h2>

<ul>
<li>Compute flow accumulation from the flow direction raster for the gage by going to Hydrology | Flow Accumulation.</li>
<li>Set the flow direction raster as b_gdir and name the output b_gaccum.</li>
</ul>

<h2 id="extract-stream-network"><strong>Extract stream network</strong></h2>

<ul>
<li>Use the Raster Calculator to extract all cells that are “channels”, i.e., flow accumulation greater than 200 (this defines a stream channel as those cells with an upstream drainage area &gt; 200 cells)

<ul>
<li>Name the output b_gstreams</li>
</ul></li>
<li>Use the Hydrology | Stream Link tool to assign each stream segment a unique ID:

<ul>
<li>Set the b_gstreams raster as the Input stream raster and the b_gdir as the input flow direction raster.</li>
<li>Name this grid b_gstrmseg</li>
</ul></li>
<li>Answer Question 7.</li>
<li>Use the Hydrology | Stream Order to assign each stream segment a numeric order (Strahler or Shreve)

<ul>
<li>Set the input stream raster to b_gstreams, the input flow direction raster to b_gdir and select Strahler method for stream ordering.</li>
<li>Name the output b_gstrahler</li>
</ul></li>
<li>Examine the stream orders and answer Question 8.</li>
</ul>

<h2 id="extract-sub-basins-for-each-stream-segment"><strong>Extract sub basins for each stream segment</strong></h2>

<ul>
<li>Use the Hydrology | Watershed tool to extract the watershed for each stream segment:

<ul>
<li>Set the input flow direction raster to b_gdir, and the b_gstrmseg as the input raster pour point data. Use value for pour point field.</li>
<li>Name the output as b_gsbasins</li>
</ul></li>
<li>Use unique color to display all the sub basins in the White Oak watershed

<ul>
<li>Create a map of the White Oak watershed (include a title &amp; your name) and save it in your Lab08 folder as a png. Call it part2yourname.png and paste it into the questions.
<br /></li>
</ul></li>
</ul>

<h2 id="compute-water-surface-flow-distance"><strong>Compute water surface flow distance</strong></h2>

<ul>
<li>Use the Hydrology | Flow Length to calculate upstream flow distance:

<ul>
<li>Set the b_gdir as the input flow direction raster and select the ‘Upstream’ option for the Direction of measurement.</li>
<li>Name the output b_gdist</li>
</ul></li>
<li>Answer Questions 9-14</li>
</ul>

<hr />

<h1 id="part-3-examining-nexrad-radar-beam-terrain-blockage"><strong>Part 3: Examining NEXRAD radar beam terrain blockage</strong></h1>

<p>In this part, we will be determining where terrain is blocking NEXRAD radar signals. We will be looking at the NEXRAD radar near Pueblo, Colorado with the designation KPUX.</p>

<h2 id="getting-set-up-2"><strong>Getting set up</strong></h2>

<ul>
<li>Either start a new session of ArcMap or insert a new dataframe and rename it to NEXRAD</li>
<li>Add dem200 and nexrad_kpux to your data frame.</li>
<li>Change the symbology for nexrad_kpux so it’s easily visible against the DEM.</li>
</ul>

<h2 id="create-nexrad-radar-beam-shapefile"><strong>Create NEXRAD radar beam shapefile</strong></h2>

<ul>
<li>In your Part03 folder, there is an application called nex2shpv8c.exe. Use Windows Explorer to browse to this file and run it by double-clicking on it.</li>
<li>We will use this application to create a point shapefile that gives us 360 radials sampling the paths of the radar beams in all directions. In the upper-right window, click on the kpux.txt file (this is a file that contains the specifications for the KPUX radar), then click the Header button. You should see something like the following:
<img src="/courses/geog558/media/Lab8Image4.png" alt="" /></li>
<li>Make sure Point Shapefile is selected, check the box to include Lon &amp; Lat info in the attribute table, and click Decode. When you get the message “Finished converting file”, close the utility.</li>
<li>Add the new shapefile to your data frame in ArcMap. You’ll notice that this file has no spatial reference, so we need to define it.</li>
</ul>

<h2 id="define-the-spatial-reference-for-the-radar-beam-shapefile"><strong>Define the spatial reference for the radar beam shapefile</strong></h2>

<ul>
<li>In ArcToolbox, go to Data Management Tools  Projections and Transformations  Define Projection. Select the kpux005pt from the dropdown and define the projection as Geographic Coordinate Systems  North America  NAD 1983 (North American Datum 1983).</li>
<li>Now that the dataset has the proper spatial reference, it should be drawn on the screen.</li>
<li>Next we need to reproject it to the DEM’s projected coordinate system.</li>
<li>In ArcToolbox, go to Data Management Tools  Projections and Transformations  Project

<ul>
<li>Make the input dataset kpux005pt and name the output kpux_rad005 and make sure it is saved in your Part03 folder.</li>
<li>Click the hand icon for the output coordinate system and then choose the projection of dem200 and then click OK (See the figure below).
<img src="/courses/geog558/media/Lab8Image5.png" alt="" /></li>
<li>The reprojected dataset will appear in your table of contents. Since we will be working with this layer from now on, remove the kpux005pt layer from the data frame.</li>
</ul></li>
</ul>

<p>Open the attribute table for kpux_rad005 and look at the fields. The DBZ field indicates the sampling point in the radial starting from the radar. The ZRAD field is an estimation of the height of the centroid of the radar beam at that location. You’ll notice that the first record has a DBZ of 0; this is the radar itself. Unfortunately, the individual radials are not indexed in any way, so we will have to do this manually.</p>

<h2 id="establish-indices-for-radar-beam-radials"><strong>Establish indices for radar beam radials</strong></h2>

<ul>
<li>Create a new field called RadialID. Make it a Short Integer.  Then, use the field calculator to enter the following expression:
Int ( ( [OBJECTID] - 2) / 230 ) + 1</li>
<li>The above expression will assign a radial ID number to each point. The actual radar instrument is assigned a zero, and the rest of the points are assigned radial IDs between 1 and 360. Beam 1 points approximately north, beam 2 is one degree clockwise from beam 1, and so on all the way around to 360, which is one degree counterclockwise from beam 1. Each beam contains 230 points.
<img src="/courses/geog558/media/Lab8Image6.png" alt="" /></li>
</ul>

<h2 id="determine-where-radar-beam-intersects-terrain"><strong>Determine where radar beam intersects terrain</strong></h2>

<ul>
<li>Determine the elevation at each of the points using the DEM. Go to ArcToolbox  Spatial Analyst Tools  Extraction  Extract Values to Points

<ul>
<li>Set the input point features to kpux_rad005, and the input raster to dem200.</li>
<li>Make the output file kpux_rex005 and be sure it is saved in your Part03 folder.</li>
</ul></li>
<li>From here on, we will be working with this new output layer, so remove the kpux_rad005 layer from your data frame.</li>
<li>Select the points in the radar beam that are lower than the terrain. Go to Selection  Select by Attributes, make the layer the kpux_rex005 layer you created in the previous step and enter: &ldquo;RASTERVALU&rdquo; &gt;= &ldquo;ZRAD&rdquo;</li>
<li>Click Apply.</li>
</ul>

<h2 id="determine-locations-where-the-radar-beam-is-blocked-by-terrain"><strong>Determine locations where the radar beam is blocked by terrain</strong></h2>

<ul>
<li>Open the attribute table for kpux_rex005.</li>
<li>Right-click on the header for the RadialID field and click Summarize. Check the Minimum box in the DBZ field, set the output file to min_blk005.dbf.

<ul>
<li>Make sure you change the file type</li>
</ul></li>
<li>Make sure it’s being saved in your Part03 folder, and that Summarize on the selected records only is checked. Click OK.
<img src="/courses/geog558/media/Lab8Image7.png" alt="" /></li>
<li>When asked about adding the table to the map, click yes.</li>
<li>Join the new table to the kpux_rex005 layer based on the RadialID field. Before clicking OK, check Keep only matching records and click OK. If asked about indexing, click yes.
<img src="/courses/geog558/media/Lab8Image8.png" alt="" /></li>
<li>Select all the points where the radar beam is blocked. Select by attributes (in the kpux_rex005 layer) and enter the following: &ldquo;kpux_rex005.DBZ&rdquo; &gt; &ldquo;min_blk005.Min_DBZ&rdquo;</li>
</ul>

<p>We now have a selection subset where the radar beam is blocked by the terrain. Answer Question #15 on your answer sheet.  Now, what we really want to see is where the beam is not blocked.</p>

<h2 id="invert-the-selection-and-create-a-radar-beam-raster"><strong>Invert the selection and create a radar beam raster</strong></h2>

<ul>
<li>Remove the join in the kpux_rex005 layer and open the attribute table.<br /></li>
<li>Under options or in the attribute table for kpux_005, click Switch Selection.

<ul>
<li>If you did this correctly you should have 75,666 points selected and your map should look like so.
<img src="/courses/geog558/media/Lab8Image9.png" alt="" /></li>
</ul></li>
<li>Convert Features to Raster based on the ZRAD field, and make the cell size 2000.</li>
<li>Call the output file rvis005 and make sure it is being saved in your Part03 folder. Save your map as kpux.mxd in your Part03 folder.
<img src="/courses/geog558/media/Lab8Image10.png" alt="" /></li>
</ul>

<h2 id="visualize-the-results-in-3-d"><strong>Visualize the results in 3-D</strong></h2>

<ul>
<li>Open <strong>ArcScene</strong>, and add the dem200 and rvis005 layers.</li>
<li>For each layer, go to Properties and click on the Base Heights tab. Click Floating on a custom surface:, and make sure the indicated layer is the same as the one you clicked on (it should be by default). Leave everything else to the defaults.</li>
<li>Change the color ramp symbology for the rvis005 layer (Properties  Symbology) to something a little more colorful.</li>
<li>Finally, adjust the Z value of the display. Right-click on Scene Layers (the data frame in ArcMap) and go to Scene Properties.  Make the vertical exaggeration 10 on General tab and click OK.</li>
<li>Add nexrad_kpux to the scene.</li>
<li>R-Click on nexrad_kpux and go to Properties  Extrusion</li>
<li>Check Extrude features in layer. Make the extrusion value 2000.</li>
<li>Change the symbology to something that shows up well. Save your scene in your Part02 folder as kpux.sxd.</li>
<li>Zoom in and navigate around the 3D image. Choose an angle that shows the radar beam origin and the beam being blocked by the terrain. Answer Questions #16 and #17 on the answer sheet.
<img src="/courses/geog558/media/Lab8Image11.png" alt="" /></li>
</ul>

<p><strong>Congratulations, you are done!  Submit your answer sheet to blackboard.</strong></p>

          </div>

          



          
        </div>

        <div class="body-footer">
          <p>Last updated on Jan 1, 0001</p>

          


          

        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.16bbb3750feb7244c9bc409a5a4fe678.js"></script>

    






  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
